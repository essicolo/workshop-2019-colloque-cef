<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>2 L’analyse de données compositionnelles | Analyse de données compositionnelles, biostatistiques et autoapprentissage avec R</title>
  <meta name="description" content="Notes de conférence pour le 13ième Colloque du CEF">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="2 L’analyse de données compositionnelles | Analyse de données compositionnelles, biostatistiques et autoapprentissage avec R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Notes de conférence pour le 13ième Colloque du CEF" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 L’analyse de données compositionnelles | Analyse de données compositionnelles, biostatistiques et autoapprentissage avec R" />
  
  <meta name="twitter:description" content="Notes de conférence pour le 13ième Colloque du CEF" />
  

<meta name="author" content="Serge-Étienne Parent">


<meta name="date" content="2019-05-02">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="index.html">
<link rel="next" href="chapitre-ml.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> L’analyse compositionnelle</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#contexte"><i class="fa fa-check"></i><b>1.1</b> Contexte</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#les-donnees-compositionnelles"><i class="fa fa-check"></i><b>1.2</b> Les données compositionnelles</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#les-transformations-compositionnelles"><i class="fa fa-check"></i><b>1.3</b> Les transformations compositionnelles</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#les-zeros"><i class="fa fa-check"></i><b>1.4</b> Les zéros</a><ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#les-zeros-arrondis"><i class="fa fa-check"></i><b>1.4.1</b> Les zéros arrondis</a></li>
<li class="chapter" data-level="1.4.2" data-path="index.html"><a href="index.html#les-decomptes-de-zero"><i class="fa fa-check"></i><b>1.4.2</b> Les décomptes de zéro</a></li>
<li class="chapter" data-level="1.4.3" data-path="index.html"><a href="index.html#les-zeros-structurels"><i class="fa fa-check"></i><b>1.4.3</b> Les zéros structurels</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chapitre-analyse.html"><a href="chapitre-analyse.html"><i class="fa fa-check"></i><b>2</b> L’analyse de données compositionnelles</a><ul>
<li class="chapter" data-level="2.1" data-path="chapitre-analyse.html"><a href="chapitre-analyse.html#imputation-de-donnees-manquantes"><i class="fa fa-check"></i><b>2.1</b> Imputation de données manquantes</a></li>
<li class="chapter" data-level="2.2" data-path="chapitre-analyse.html"><a href="chapitre-analyse.html#detection-de-valeurs-aberrantes"><i class="fa fa-check"></i><b>2.2</b> Détection de valeurs aberrantes</a></li>
<li class="chapter" data-level="2.3" data-path="chapitre-analyse.html"><a href="chapitre-analyse.html#biostats-compositionnelles"><i class="fa fa-check"></i><b>2.3</b> Biostats compositionnelles</a><ul>
<li class="chapter" data-level="2.3.1" data-path="chapitre-analyse.html"><a href="chapitre-analyse.html#les-compositions-comme-variables-reponse"><i class="fa fa-check"></i><b>2.3.1</b> Les compositions comme variables-réponse</a></li>
<li class="chapter" data-level="2.3.2" data-path="chapitre-analyse.html"><a href="chapitre-analyse.html#les-compositions-comme-variables-explicatives"><i class="fa fa-check"></i><b>2.3.2</b> Les compositions comme variables explicatives</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="chapitre-analyse.html"><a href="chapitre-analyse.html#bioheuristique-compositionnelle"><i class="fa fa-check"></i><b>2.4</b> Bioheuristique compositionnelle</a><ul>
<li class="chapter" data-level="2.4.1" data-path="chapitre-analyse.html"><a href="chapitre-analyse.html#partitionnement"><i class="fa fa-check"></i><b>2.4.1</b> Partitionnement</a></li>
<li class="chapter" data-level="2.4.2" data-path="chapitre-analyse.html"><a href="chapitre-analyse.html#la-distance-daitchison-par-rapport-au-barycentre-est-une-diversite"><i class="fa fa-check"></i><b>2.4.2</b> La distance d’Aitchison par rapport au barycentre est une diversité</a></li>
<li class="chapter" data-level="2.4.3" data-path="chapitre-analyse.html"><a href="chapitre-analyse.html#ordination"><i class="fa fa-check"></i><b>2.4.3</b> Ordination</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapitre-ml.html"><a href="chapitre-ml.html"><i class="fa fa-check"></i><b>3</b> Autoapprentissage compositionnel</a><ul>
<li class="chapter" data-level="3.1" data-path="chapitre-ml.html"><a href="chapitre-ml.html#lexique"><i class="fa fa-check"></i><b>3.1</b> Lexique</a></li>
<li class="chapter" data-level="3.2" data-path="chapitre-ml.html"><a href="chapitre-ml.html#demarche"><i class="fa fa-check"></i><b>3.2</b> Démarche</a><ul>
<li class="chapter" data-level="3.2.1" data-path="chapitre-ml.html"><a href="chapitre-ml.html#pretraitement"><i class="fa fa-check"></i><b>3.2.1</b> Prétraitement</a></li>
<li class="chapter" data-level="3.2.2" data-path="chapitre-ml.html"><a href="chapitre-ml.html#entrainement-et-test"><i class="fa fa-check"></i><b>3.2.2</b> Entraînement et test</a></li>
<li class="chapter" data-level="3.2.3" data-path="chapitre-ml.html"><a href="chapitre-ml.html#validation-croisee"><i class="fa fa-check"></i><b>3.2.3</b> Validation croisée</a></li>
<li class="chapter" data-level="3.2.4" data-path="chapitre-ml.html"><a href="chapitre-ml.html#choix-de-lalgorithme-dapprentissage"><i class="fa fa-check"></i><b>3.2.4</b> Choix de l’algorithme d’apprentissage</a></li>
<li class="chapter" data-level="3.2.5" data-path="chapitre-ml.html"><a href="chapitre-ml.html#deploiement"><i class="fa fa-check"></i><b>3.2.5</b> Déploiement</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="chapitre-ml.html"><a href="chapitre-ml.html#en-resume"><i class="fa fa-check"></i><b>3.3</b> En résumé,</a></li>
<li class="chapter" data-level="3.4" data-path="chapitre-ml.html"><a href="chapitre-ml.html#lautoapprentissage-en-r"><i class="fa fa-check"></i><b>3.4</b> L’autoapprentissage en R</a></li>
<li class="chapter" data-level="3.5" data-path="chapitre-ml.html"><a href="chapitre-ml.html#les-k-plus-proches-voisins"><i class="fa fa-check"></i><b>3.5</b> Les <em>k</em> plus proches voisins</a><ul>
<li class="chapter" data-level="3.5.1" data-path="chapitre-ml.html"><a href="chapitre-ml.html#exemple-dapplication"><i class="fa fa-check"></i><b>3.5.1</b> Exemple d’application</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="chapitre-ml.html"><a href="chapitre-ml.html#les-processus-gaussiens"><i class="fa fa-check"></i><b>3.6</b> Les processus gaussiens</a><ul>
<li class="chapter" data-level="3.6.1" data-path="chapitre-ml.html"><a href="chapitre-ml.html#exemple-dapplication-1"><i class="fa fa-check"></i><b>3.6.1</b> Exemple d’application</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Analyse de données compositionnelles, biostatistiques et autoapprentissage avec R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapitre-analyse" class="section level1">
<h1><span class="header-section-number">2</span> L’analyse de données compositionnelles</h1>
<p>Nous avons vu au chapitre <a href="index.html#chapitre-intro-coda">1</a> que les données compositionnelles doivent subir une transformation préalable en vue d’être analysées et modélisées. S’il
faut être prudent sur l’interprétation des variables transformées, il faut aussi l’être sur les statistiques qui leur sont associées. En effet, les variables ayant subit une transformation compositionnelle peuvent être intégrés dans des flux de calculs en biostatistiques (tests d’hypothèses, modèles linéaires ou non linéaires, etc.) ou en bioheuristique (partitionnement, ordination, etc.), en passant par la détection de valeurs aberrantes et l’imputation de données manquantes.</p>
<div id="imputation-de-donnees-manquantes" class="section level2">
<h2><span class="header-section-number">2.1</span> Imputation de données manquantes</h2>
<p>Pour toutes sortes de raison, il arrive parfois que des données soient manquantes. Les données manquantes se répartissent selon différents cas de figures (<a href="https://www.springer.com/us/book/9781461440178">Graham, 2012</a>; <a href="https://onlinelibrary.wiley.com/doi/book/10.1002/9781119013563">Little et Rubin, 2002</a>) dont trois principaux:</p>
<ul>
<li>les valeurs manquantes univariées: pour une variable donnée, si une observation est absente, alors toutes les observations suivantes pour cette variable sont absentes (figure <a href="chapitre-analyse.html#fig:mv-types">2.1</a>a).</li>
<li>les valeurs manquantes monotones: la valeur d’une variable <span class="math inline">\(Y_j\)</span> manquante pour un individu <span class="math inline">\(i\)</span> implique que toutes les variables suivantes <span class="math inline">\(Y_k\)</span> (<span class="math inline">\(k &gt; j\)</span>) sont manquantes pour cet individu (figure <a href="chapitre-analyse.html#fig:mv-types">2.1</a>b).</li>
<li>les valeurs manquantes arbitraires: la matrice ne dessine spécifiquement aucune des formes précédentes (figure <a href="chapitre-analyse.html#fig:mv-types">2.1</a>c).</li>
</ul>
<div class="figure" style="text-align: center"><span id="fig:mv-types"></span>
<img src="images/08_mv-types.png" alt="Exemple de profils de données manquantes" width="100%" />
<p class="caption">
Figure 2.1: Exemple de profils de données manquantes
</p>
</div>
<p>Le module VIM permet de visualiser la structure des données manquantes.</p>
<p>Pour l’exemple, prenons le tableau <code>coffee</code>, qui comprend la composition chimique de plusieurs échantillons associés à un cultivar, puis remplaçons au hasard des données par des valeurs manquantes (<code>NA</code>), puis vérifions les proportions de données manquantes et les proportions de combinaisons de données manquantes.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">867209</span>)
<span class="kw">data</span>(<span class="st">&quot;coffee&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;robCompositions&quot;</span>)
coffee_NA &lt;-<span class="st"> </span>coffee
n_NA &lt;-<span class="st"> </span><span class="dv">15</span>
row_NA &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(coffee), n_NA, <span class="dt">replace =</span> <span class="ot">TRUE</span>)
col_NA &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">2</span><span class="op">:</span><span class="kw">ncol</span>(coffee), n_NA, <span class="dt">replace =</span> <span class="ot">TRUE</span>)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n_NA) coffee_NA[row_NA[i], col_NA[i]] &lt;-<span class="st"> </span><span class="ot">NA</span>

<span class="kw">summary</span>(<span class="kw">aggr</span>(coffee_NA, <span class="dt">sortVar =</span> <span class="ot">TRUE</span>))</code></pre>
<div class="figure" style="text-align: center"><span id="fig:vim-diag"></span>
<img src="_main_files/figure-html/vim-diag-1.png" alt="Portrait des valeurs manquantes avec **`VIM`**." width="100%" />
<p class="caption">
Figure 2.2: Portrait des valeurs manquantes avec <strong><code>VIM</code></strong>.
</p>
</div>
<pre><code>## 
##  Variables sorted by number of missings: 
##  Variable      Count
##    metpyr 0.13333333
##  furfualc 0.10000000
##      met5 0.10000000
##      acit 0.06666667
##     furfu 0.06666667
##    dimeth 0.03333333
##      sort 0.00000000</code></pre>
<pre><code>## 
##  Missings per variable: 
##  Variable Count
##      sort     0
##      acit     2
##    metpyr     4
##     furfu     2
##  furfualc     3
##    dimeth     1
##      met5     3
## 
##  Missings in combinations of variables: 
##   Combinations Count   Percent
##  0:0:0:0:0:0:0    18 60.000000
##  0:0:0:0:0:0:1     2  6.666667
##  0:0:0:0:0:1:0     1  3.333333
##  0:0:0:0:1:0:0     1  3.333333
##  0:0:0:0:1:0:1     1  3.333333
##  0:0:0:1:0:0:0     1  3.333333
##  0:0:1:0:0:0:0     2  6.666667
##  0:0:1:0:1:0:0     1  3.333333
##  0:0:1:1:0:0:0     1  3.333333
##  0:1:0:0:0:0:0     2  6.666667</code></pre>
<p>Pour imputer les valeurs manquantes, une méthode commune est d’inspecter les valeurs des vecteurs les plus proches ne manquant pas la donnée en question et d’imputer la moyenne ou la médiane de ces valeurs (algoritmhe des KNN, que nous verrons toute à l’heure). La notion de “plus proche” imlique le calcul d’une distance. Or les distances entre compositions sont peu fiables. On pourrait imputer des <em>ilr</em>, mais le changement d’un <em>ilr</em> entraînera une perturbation d’au moins une autre concentration. La fonction <code>robCompositions::impCoda()</code> utilise des méthodes robustes pour imputer directement les compositions.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;robCompositions&quot;</span>)
coffee_imp &lt;-<span class="st"> </span><span class="kw">impCoda</span>(coffee_NA[, <span class="dv">-1</span>])<span class="op">$</span>xImp
coffee_imp</code></pre>
</div>
<div id="detection-de-valeurs-aberrantes" class="section level2">
<h2><span class="header-section-number">2.2</span> Détection de valeurs aberrantes</h2>
<p>Les valeurs aberrantes peuvent avoir un effet important sur les stats. Elles sont aussi parfois une occasion d’inspecter les données et de détecter des mécanismes jusqu’alors insoupsonnés. Les données aberrantes peuvent avantageusement être détectées sur des données transformées. Encore faut-il utiliser des statistiques robustes.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;mvoutlier&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;ellipse&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;ggtern&quot;</span>)
<span class="kw">data</span>(<span class="st">&quot;coffee&quot;</span>)
sbp &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,
                <span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>),
              <span class="dt">ncol =</span> <span class="dv">3</span>,
              <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
coffee_comp &lt;-<span class="st"> </span>coffee <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(acit, metpyr, furfu) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">acomp</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">as_tibble</span>()
coffee_ilr &lt;-<span class="st"> </span>coffee_comp <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ilr</span>(., <span class="dt">V =</span> <span class="kw">gsi.buildilrBase</span>(<span class="kw">t</span>(sbp))) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">as_tibble</span>(.) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">rename</span>(<span class="dt">furfu_metpyr.acit =</span> V1,
                <span class="dt">metpyr_acit =</span> V2)

elldev_ilr &lt;-<span class="st"> </span><span class="kw">ellipse</span>(<span class="dt">x =</span> <span class="kw">cov</span>(coffee_ilr),
                      <span class="dt">centre =</span> <span class="kw">apply</span>(coffee_ilr, <span class="dv">2</span>, mean),
                      <span class="dt">level =</span> <span class="fl">0.975</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">as_tibble</span>()

mcd &lt;-<span class="st"> </span><span class="kw">covMcd</span>(coffee_ilr)
elldev_ilr_rob &lt;-<span class="st"> </span><span class="kw">ellipse</span>(<span class="dt">x =</span> mcd<span class="op">$</span>cov,
                          <span class="dt">centre =</span> mcd<span class="op">$</span>center,
                          <span class="dt">level =</span> <span class="fl">0.975</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">as_tibble</span>()

coffee_ilr <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> furfu_metpyr.acit, <span class="dt">y =</span> metpyr_acit)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_path</span>(<span class="dt">data =</span> elldev_ilr, <span class="kw">aes</span>(<span class="dt">x =</span> furfu_metpyr.acit, <span class="dt">y =</span> metpyr_acit), <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_path</span>(<span class="dt">data =</span> elldev_ilr_rob, <span class="kw">aes</span>(<span class="dt">x =</span> furfu_metpyr.acit, <span class="dt">y =</span> metpyr_acit), <span class="dt">colour =</span> <span class="st">&quot;green&quot;</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:robuste"></span>
<img src="_main_files/figure-html/robuste-1.png" alt="Valeurs manquantes sans (rouge) et avec (vert) méthodes robustes." width="100%" />
<p class="caption">
Figure 2.3: Valeurs manquantes sans (rouge) et avec (vert) méthodes robustes.
</p>
</div>
<p>Les fonctions <code>mvoutlier::sign1()</code> et <code>mvoutlier::sign2()</code> utilise justement les méthodes robustes pour détecter des valeurs aberrantes. La méthode <code>mvoutlier::sign1()</code> sebase sur les composantes principales robustes.</p>
<pre class="sourceCode r"><code class="sourceCode r">coffee_ilr &lt;-<span class="st"> </span>coffee_ilr <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">is_outlier =</span> <span class="kw">sign2</span>(<span class="kw">as.matrix</span>(.), <span class="dt">qcrit =</span> <span class="fl">0.975</span>)<span class="op">$</span>wfinal01 <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)

coffee_ilr <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> furfu_metpyr.acit, <span class="dt">y =</span> metpyr_acit)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">colour =</span> is_outlier)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_path</span>(<span class="dt">data =</span> elldev_ilr, <span class="kw">aes</span>(<span class="dt">x =</span> furfu_metpyr.acit, <span class="dt">y =</span> metpyr_acit), <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_path</span>(<span class="dt">data =</span> elldev_ilr_rob, <span class="kw">aes</span>(<span class="dt">x =</span> furfu_metpyr.acit, <span class="dt">y =</span> metpyr_acit), <span class="dt">colour =</span> <span class="st">&quot;green&quot;</span>)</code></pre>
<div class="figure" style="text-align: center"><span id="fig:outliers"></span>
<img src="_main_files/figure-html/outliers-1.png" alt="Valeurs manquantes sans (rouge) et avec (vert) méthodes robustes." width="100%" />
<p class="caption">
Figure 2.4: Valeurs manquantes sans (rouge) et avec (vert) méthodes robustes.
</p>
</div>
</div>
<div id="biostats-compositionnelles" class="section level2">
<h2><span class="header-section-number">2.3</span> Biostats compositionnelles</h2>
<p>La régression linéaire est une des méthodes statistiques les plus communes. Elle permet d’apprécier les effets de variables explicatives sur des variables-réponse. À cet égard, les compositions peuvent autant expliquer que servir de variable de sortie.</p>
<div id="les-compositions-comme-variables-reponse" class="section level3">
<h3><span class="header-section-number">2.3.1</span> Les compositions comme variables-réponse</h3>
<p>Les données <code>ArcticLake</code> présentent la granulo pour différentes profondeurs de sédiments. La profondeur peut-être expliquer la granulo? Nous allons d’abord transformer la texture en <em>ilr</em>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">&quot;ArcticLake&quot;</span>)
granu_comp &lt;-<span class="st"> </span><span class="kw">acomp</span>(ArcticLake[, <span class="dv">-4</span>])
sbp &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,
                <span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>),
              <span class="dt">ncol =</span> <span class="dv">3</span>,
              <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
granu_ilr &lt;-<span class="st"> </span><span class="kw">ilr</span>(granu_comp, <span class="dt">V =</span> <span class="kw">gsi.buildilrBase</span>(<span class="kw">t</span>(sbp))) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">depth =</span> ArcticLake[, <span class="dv">4</span>])
<span class="kw">names</span>(granu_ilr)[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;c_sS&quot;</span>, <span class="st">&quot;s_S&quot;</span>)</code></pre>
<p>Nous avons ici deux sorties (balances [c | s,S] et [s | S]) et une entrée (la profondeur). Créons deux modèles.</p>
<pre class="sourceCode r"><code class="sourceCode r">mod1 &lt;-<span class="st"> </span><span class="kw">lm</span>(c_sS <span class="op">~</span><span class="st"> </span>depth, granu_ilr)
mod2 &lt;-<span class="st"> </span><span class="kw">lm</span>(s_S <span class="op">~</span><span class="st"> </span>depth, granu_ilr)</code></pre>
<p>Inspectons le modèle 1.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(mod1)</code></pre>
<pre><code>## 
## Call:
## lm(formula = c_sS ~ depth, data = granu_ilr)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.52419 -0.51847 -0.04614  0.46839  2.52374 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  1.86983    0.26341   7.099 2.09e-08 ***
## depth       -0.03545    0.00475  -7.464 6.88e-09 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.822 on 37 degrees of freedom
## Multiple R-squared:  0.6009, Adjusted R-squared:  0.5901 
## F-statistic: 55.72 on 1 and 37 DF,  p-value: 6.882e-09</code></pre>
<p>L’intercept est la valeur de la balance [c | s,S] à profondeur nulle. Une balance positive montre que l’argile prend moins de place dans la composition que la moyenne géométrique du limon et du sable. La pente négative montre que la balance tend à diminuer en profondeur, c’est à dire que l’argile prend relativement de plus en plus de place en profondeur.</p>
<p>Prédisons nos <em>ilr</em>.</p>
<pre class="sourceCode r"><code class="sourceCode r">pred1 &lt;-<span class="st"> </span><span class="kw">predict</span>(mod1)
pred2 &lt;-<span class="st"> </span><span class="kw">predict</span>(mod2)

<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))
<span class="kw">plot</span>(granu_ilr<span class="op">$</span>c_sS, <span class="op">-</span>granu_ilr<span class="op">$</span>depth)
<span class="kw">lines</span>(pred1, <span class="op">-</span>granu_ilr<span class="op">$</span>depth, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)
<span class="kw">plot</span>(granu_ilr<span class="op">$</span>s_S, <span class="op">-</span>granu_ilr<span class="op">$</span>depth)
<span class="kw">lines</span>(pred2, <span class="op">-</span>granu_ilr<span class="op">$</span>depth, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<p>Les modèles linéaires ne sont vraisemblabelment pas adéquats: on aurait avantage à transformer la profondeur en log. Mais passons. Le fait est que l’on peut transformer nos deux prédictions en composition, puis présenter une régression linéaire dans un diagramme ternaire.</p>
<pre class="sourceCode r"><code class="sourceCode r">pred_comp &lt;-<span class="st"> </span><span class="kw">ilrInv</span>(<span class="kw">cbind</span>(pred1, pred2), <span class="dt">V =</span> <span class="kw">gsi.buildilrBase</span>(<span class="kw">t</span>(sbp)))

<span class="kw">plot</span>(granu_comp)
<span class="kw">lines</span>(pred_comp, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
</div>
<div id="les-compositions-comme-variables-explicatives" class="section level3">
<h3><span class="header-section-number">2.3.2</span> Les compositions comme variables explicatives</h3>
<p>Disons que j’aimerais voir quel est l’effet de la compostion chimique d’un humus sur son pH.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">&quot;humus&quot;</span>)
humus_comp &lt;-<span class="st"> </span>humus <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(C, N, P, K, Ca, Mg) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Fv =</span> <span class="fl">1e6</span> <span class="op">-</span><span class="st"> </span>C <span class="op">-</span><span class="st"> </span>N <span class="op">-</span><span class="st"> </span>P <span class="op">-</span><span class="st"> </span>K <span class="op">-</span><span class="st"> </span>Ca <span class="op">-</span><span class="st"> </span>Mg) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">acomp</span>(.)
sbp &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>( <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,
                 <span class="dv">-1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>,
                 <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>,
                 <span class="dv">0</span>, <span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>,
                 <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>,
                 <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>),
              <span class="dt">byrow =</span> <span class="ot">TRUE</span>, <span class="dt">ncol =</span> <span class="dv">7</span>)
<span class="kw">CoDaDendrogram</span>(humus_comp, <span class="dt">V =</span> <span class="kw">gsi.buildilrBase</span>(<span class="kw">t</span>(sbp)))</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<p>La SBP est structurée pour exclure d’abord l’amalgamation Fv dans la balance [Fv | C,Mg,Ca,K,P,N]. Puis, J’exclue le carbone des nutriments dans [C | Mg,Ca,K,P,N]. La balance suivante, [Mg,Ca,K | P,N], est un log-ratio entre anions et cations. Ensuite, le Redfield-ratio est exprimé par la balance [P | N]. Puis je balance les cations selon leur valence dans [Mg,Ca | K]. La balance restante est [Mg | Ca].</p>
<p>Calculons les ilr puis lançons le modèle linéaire.</p>
<pre class="sourceCode r"><code class="sourceCode r">humus_ilr &lt;-<span class="st"> </span><span class="kw">ilr</span>(humus_comp, <span class="dt">V =</span> <span class="kw">gsi.buildilrBase</span>(<span class="kw">t</span>(sbp))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">as_tibble</span>()</code></pre>
<p>J’ai conçu un petit algorithme pour définit les balances. Pour l’utiliser, il faut exécuter son code et il faut que la SBP ait des noms de colonne.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">source</span>(<span class="st">&quot;https://raw.githubusercontent.com/essicolo/AgFun/master/ilrDefinition.R&quot;</span>)
<span class="kw">colnames</span>(sbp) &lt;-<span class="st"> </span><span class="kw">colnames</span>(humus_comp)
<span class="kw">names</span>(humus_ilr) &lt;-<span class="st"> </span><span class="kw">ilrDefinition</span>(sbp, <span class="st">&quot;-+&quot;</span>)</code></pre>
<p>J’ajoute la colonne <code>pH</code> au tableau d’<em>ilr</em>, puis je lance le modèle linéaire.</p>
<pre class="sourceCode r"><code class="sourceCode r">humus_ilr &lt;-<span class="st"> </span>humus_ilr <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pH =</span> humus<span class="op">$</span>pH)
modlin &lt;-<span class="st"> </span><span class="kw">lm</span>(pH <span class="op">~</span><span class="st"> </span>., humus_ilr)
<span class="kw">summary</span>(modlin)</code></pre>
<pre><code>## 
## Call:
## lm(formula = pH ~ ., data = humus_ilr)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.75228 -0.11364 -0.01487  0.10291  0.79732 
## 
## Coefficients:
##                        Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)             4.21737    0.58342   7.229 1.46e-12 ***
## `[Fv | Mg,Ca,K,P,N,C]`  0.11781    0.06061   1.944   0.0524 .  
## `[C | Mg,Ca,K,P,N]`     0.80107    0.05695  14.065  &lt; 2e-16 ***
## `[Mg,Ca,K | P,N]`       0.15985    0.03066   5.213 2.55e-07 ***
## `[P | N]`               0.07187    0.05405   1.330   0.1841    
## `[Mg,Ca | K]`          -0.19108    0.02628  -7.271 1.10e-12 ***
## `[Mg | Ca]`             0.02883    0.02570   1.122   0.2624    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1806 on 610 degrees of freedom
## Multiple R-squared:  0.4846, Adjusted R-squared:  0.4795 
## F-statistic: 95.59 on 6 and 610 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>L’intercept est la valeur du pH lorsque toutes les balances sont nulles. Cette information n’est pas intéressante. Quant aux pentes, on pourra les interpréter comme suit. Une pente positive de <code>{r} round(coef(modlin)[3], 5)</code> sur la variable [C | Mg,Ca,K,P,N] signifie que plus la balance est élevée, plus le pH est élevé. Une balance plus élevée signifie que la moyenne géométrique du numérateur [Mg,Ca,K,P,N] gagne de plus en plus en importance par rapport que celle du dénominateur [C].</p>
<p>De même, une pente de <code>{r} round(coef(modlin)[6], 5)</code> indique qu’à chaque fois que la balance [Mg,Ca | K] augmente de 1 unité (c’est ce qui se passerait si K augmenterait ou que Mg et/ou Ca diminuerait), le pH diminue de <code>{r} round(coef(modlin)[6], 5)</code>.</p>
<p>Les coefficients de pente, qui sont des perspectives exprimées en balances, changeraient si la sbp était différente, mais la régression serait la même (même intercept, même R²). On pourra même transformer les pente en une composition pour obtenir ce que l’on appelle une <em>perturbation</em> (<a href="https://doi.org/10.1007/978-3-319-96422-5">Filzmoser et al. (2018)</a>, chapitre 3.2).</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ilrInv</span>(<span class="kw">coef</span>(modlin)[<span class="op">-</span><span class="dv">1</span>], <span class="dt">V =</span> <span class="kw">gsi.buildilrBase</span>(<span class="kw">t</span>(sbp)))</code></pre>
<pre><code>##          C          N          P          K         Ca         Mg 
## 0.06696377 0.18494427 0.16706972 0.12996935 0.16762141 0.16092365 
##         Fv 
## 0.12250782 
## attr(,&quot;class&quot;)
## [1] acomp</code></pre>
</div>
</div>
<div id="bioheuristique-compositionnelle" class="section level2">
<h2><span class="header-section-number">2.4</span> Bioheuristique compositionnelle</h2>
<div id="partitionnement" class="section level3">
<h3><span class="header-section-number">2.4.1</span> Partitionnement</h3>
<p>La distance entre deux compositions est un distance d’Aitchison. Cette distance est une distance euclidienne calculée sur des <em>clr</em> ou des <em>ilr</em>. Les distances n’étant pas affectées pas la formulation de la sbp, je me permets d’utiliser une sbp quelconque.</p>
<pre class="sourceCode r"><code class="sourceCode r">coffee_ilr2 &lt;-<span class="st"> </span>coffee <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>sort) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ilr</span>(.) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">as_tibble</span>()

coffee_aitdist &lt;-<span class="st"> </span>coffee_ilr2 <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">dist</span>(., <span class="dt">method =</span> <span class="st">&quot;euclidian&quot;</span>)</code></pre>
<p>La distance permet notamment d’effectuer du partitionnement (<em>clustering</em>, je vous réfère aux <a href="https://essicolo.github.io/ecologie-mathematique-R/chapitre-ordination.html#partitionnement">notes de mon cours GAE-7007</a> pour plus de détails sur le partitionnement).</p>
<pre class="sourceCode r"><code class="sourceCode r">coffee_clust &lt;-<span class="st"> </span><span class="kw">as.dendrogram</span>(<span class="kw">hclust</span>(coffee_aitdist, <span class="dt">method =</span> <span class="st">&quot;average&quot;</span>))
<span class="kw">library</span>(<span class="st">&quot;dendextend&quot;</span>) <span class="co"># pour colorer les feuilles</span>
<span class="kw">labels_colors</span>(coffee_clust) &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(coffee<span class="op">$</span>sort)
<span class="kw">plot</span>(coffee_clust)</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<p>Les échantillons 6 et 15 semblent mal classés, mais somme toute, c’est pas mal!</p>
</div>
<div id="la-distance-daitchison-par-rapport-au-barycentre-est-une-diversite" class="section level3">
<h3><span class="header-section-number">2.4.2</span> La distance d’Aitchison par rapport au barycentre est une diversité</h3>
<p>Notez que la distance d’Aitchison par rapport au barycentre d’une composition (où toutes les proportions sont égales) est un indicateur de diversité.</p>
<p>Je créé une grille sur laquelle je vais calculer des indicateurs de diversité.</p>
<pre class="sourceCode r"><code class="sourceCode r">n &lt;-<span class="st"> </span><span class="dv">10000</span>
p1 &lt;-<span class="st"> </span><span class="kw">runif</span>(n, <span class="dt">min=</span><span class="dv">0</span>, <span class="dt">max=</span><span class="dv">1</span>)
p2 &lt;-<span class="st"> </span><span class="kw">runif</span>(n, <span class="dt">min=</span><span class="dv">0</span>, <span class="dt">max=</span><span class="dv">1</span>)
p3 &lt;-<span class="st"> </span><span class="kw">runif</span>(n, <span class="dt">min=</span><span class="dv">0</span>, <span class="dt">max=</span><span class="dv">1</span>)
comp_grid &lt;-<span class="st"> </span><span class="kw">tibble</span>(p1, p2, p3)
ilr_grid &lt;-<span class="st"> </span><span class="kw">ilr</span>(comp_grid)</code></pre>
<p>Puis je calcule la distance d’Aitchison par rapport au barycentre.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;vegan&quot;</span>)

ilr_grid &lt;-<span class="st"> </span><span class="kw">ilr</span>(comp_grid)
comp_grid &lt;-<span class="st"> </span>comp_grid <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">aitdist =</span> <span class="kw">sqrt</span>(ilr_grid[, <span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>ilr_grid[, <span class="dv">2</span>]<span class="op">^</span><span class="dv">2</span>),
         <span class="dt">shannon =</span> <span class="kw">diversity</span>(., <span class="dt">index =</span> <span class="st">&quot;shannon&quot;</span>))</code></pre>
<p>Les graphiques sont crées ici avec <strong><code>ggtern</code></strong>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;ggtern&quot;</span>)
gg_aitdist &lt;-<span class="st"> </span><span class="kw">ggtern</span>(<span class="dt">data =</span> comp_grid, <span class="kw">aes</span>(p1, p2, p3)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> aitdist)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_colour_viridis_c</span>(<span class="dt">option =</span> <span class="st">&quot;inferno&quot;</span>, <span class="dt">direction =</span> <span class="dv">1</span>)

gg_shannon &lt;-<span class="st"> </span><span class="kw">ggtern</span>(<span class="dt">data =</span> comp_grid, <span class="kw">aes</span>(p1, p2, p3)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> shannon)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_colour_viridis_c</span>(<span class="dt">option =</span> <span class="st">&quot;inferno&quot;</span>, <span class="dt">direction =</span> <span class="dv">-1</span>)
cowplot<span class="op">::</span><span class="kw">plot_grid</span>(gg_aitdist, gg_shannon)</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
</div>
<div id="ordination" class="section level3">
<h3><span class="header-section-number">2.4.3</span> Ordination</h3>
<p>Exercice d’analyse discriminante sur l’ionome.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chapitre-ml.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
